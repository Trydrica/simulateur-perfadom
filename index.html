<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Simulateur Perfadom</title>
</head>
<body>
  <h1>Simulateur Perfadom</h1>

  <form id="perfadomForm">
    <label>Type de perfusion :</label>
    <select id="type" required>
      <option value="">-- Choisir --</option>
      <option value="electrique">Système actif électrique</option>
      <option value="diffuseur">Diffuseur portable</option>
      <option value="gravite">Gravité</option>
    </select><br><br>

    <label>Nombre de perfusions par jour :</label>
    <input type="number" id="perfsParJour" min="1" required><br><br>

    <label>Nombre de jours de traitement :</label>
    <input type="number" id="duree" min="1" required><br><br>

    <label><input type="checkbox" id="installation"> Première installation</label><br>
    <label><input type="checkbox" id="intercure"> Entretien inter-cure</label><br>
    <label><input type="checkbox" id="debranchement"> Débranchement après hôpital</label><br><br>

    <button type="submit">Calculer</button>
  </form>

  <h2>Résultat :</h2>
  <div id="resultat" style="margin-top: 20px;"></div>

  <script>
    document.getElementById('perfadomForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const type = document.getElementById('type').value;
      const perfs = parseInt(document.getElementById('perfsParJour').value);
      const jours = parseInt(document.getElementById('duree').value);
      const installation = document.getElementById('installation').checked;
      const intercure = document.getElementById('intercure').checked;
      const debranchement = document.getElementById('debranchement').checked;

      const resultDiv = document.getElementById('resultat');
      resultDiv.innerHTML = "";

      // --- Validation ---
      if (!type || isNaN(perfs) || perfs < 1 || isNaN(jours) || jours < 1) {
        resultDiv.innerHTML = "<span style='color:red;'>Veuillez remplir correctement tous les champs obligatoires.</span>";
        return;
      }

      let result = "";
      const semaines = Math.ceil(jours / 7);

      // --- Forfaits d'installation ---
      if (installation) {
        switch (type) {
          case "electrique":
            result += "- Installation 1ère perf : PERFADOM 1 — 357,20 €<br>";
            if (perfs >= 2) result += "- Installation 2e perf : PERFADOM 2 — 52,80 €<br>";
            if (perfs >= 3) result += "- Installation 3e perf : PERFADOM 7 — 52,80 €<br>";
            if (perfs >= 4) result += "- Installation 4e perf : PERFADOM 8 — 52,80 €<br>";
            break;
          case "diffuseur":
            result += "- Installation 1ère perf : PERFADOM 4 — 135,33 €<br>";
            if (perfs >= 2) result += "- Installation 2e perf : PERFADOM 5 — 52,80 €<br>";
            if (perfs >= 3) result += "- Installation 3e perf : PERFADOM 7 — 52,80 €<br>";
            if (perfs >= 4) result += "- Installation 4e perf : PERFADOM 8 — 52,80 €<br>";
            break;
          case "gravite":
            result += "- Installation + suivi : PERFADOM 6 — 74,57 €<br>";
            break;
        }
      }

      // --- Forfaits de suivi (hebdomadaires) ---
      if (type === 'electrique') {
        if (perfs === 1) result += `- Suivi : PERFADOM 30 × ${semaines} — 240,15 €/semaine<br>`;
        else if (perfs === 2) result += `- Suivi : PERFADOM 31 × ${semaines} — 469,44 €/semaine<br>`;
        else if (perfs === 3) result += `- Suivi : PERFADOM 32 × ${semaines} — 693,36 €/semaine<br>`;
        else result += `- Suivi : PERFADOM 33 × ${semaines} — 815,18 €/semaine<br>`;
      }

      if (type === 'diffuseur') {
        if (perfs === 1) result += `- Suivi : PERFADOM 25 × ${semaines} — 113,28 €/semaine<br>`;
        else if (perfs === 2) result += `- Suivi : PERFADOM 26 × ${semaines} — 226,56 €/semaine<br>`;
        else result += `- Suivi : PERFADOM 27 × ${semaines} — 339,84 €/semaine<br>`;
      }

      if (type === 'gravite') {
        const totalPerfs = perfs * jours;
        if (perfs > 2) result += `- Suivi : PERFADOM 20 × ${semaines} — 204,24 €/semaine<br>`;
        else if (perfs === 2) result += `- Suivi : PERFADOM 19 × ${semaines} — 122,97 €/semaine<br>`;
        else if (perfs === 1) result += `- Suivi : PERFADOM 18 × ${semaines} — 74,57 €/semaine<br>`;
        else if (totalPerfs < 15) result += `- À la perfusion : PERFADOM 17 × ${totalPerfs} — 10,80 €/perf<br>`;
      }

      // --- Autres forfaits ---
      if (intercure) result += "- Entretien inter-cure : PERFADOM 10 — tarif selon perfusion<br>";
      if (debranchement) result += "- Débranchement : PERFADOM 45 — 50 €<br>";

      resultDiv.innerHTML = result || "Aucun forfait applicable.";
    });
  </script>
</body>
</html>